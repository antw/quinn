<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>jquery.quinn.js</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>jquery.quinn.js</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        

      </td>
      <td class=code>
        <div class='highlight'><pre><span class="sr">//</span> <span class="n">vim</span><span class="p">:</span> <span class="n">set</span> <span class="n">sw</span><span class="o">=</span><span class="mi">4</span> <span class="n">ts</span><span class="o">=</span><span class="mi">4</span> <span class="n">et</span><span class="p">:</span>

<span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="vg">$,</span> <span class="n">_</span><span class="p">)</span> <span class="p">{</span>
    <span class="s2">&quot;use strict&quot;</span><span class="p">;</span>

    <span class="sr">//</span> <span class="no">Event</span> <span class="n">names</span> <span class="n">used</span> <span class="k">for</span> <span class="n">setting</span> <span class="n">up</span> <span class="n">drag</span> <span class="n">events</span><span class="o">.</span>
    <span class="n">var</span> <span class="no">DRAG_E</span>           <span class="o">=</span> <span class="s1">&#39;mousemove&#39;</span><span class="p">,</span>
        <span class="no">DRAG_START_E</span>     <span class="o">=</span> <span class="s1">&#39;mousedown&#39;</span><span class="p">,</span>
        <span class="no">DRAG_END_E</span>       <span class="o">=</span> <span class="s1">&#39;mouseup&#39;</span><span class="p">,</span>
        <span class="no">IS_TOUCH_ENABLED</span> <span class="o">=</span>  <span class="kp">false</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;ontouchstart&#39;</span> <span class="k">in</span> <span class="n">document</span><span class="o">.</span><span class="n">documentElement</span><span class="p">)</span> <span class="p">{</span>
        <span class="no">DRAG_E</span>           <span class="o">=</span> <span class="s1">&#39;touchmove&#39;</span><span class="p">;</span>
        <span class="no">DRAG_START_E</span>     <span class="o">=</span> <span class="s1">&#39;touchstart&#39;</span><span class="p">;</span>
        <span class="no">DRAG_END_E</span>       <span class="o">=</span> <span class="s1">&#39;touchend&#39;</span><span class="p">;</span>
        <span class="no">IS_TOUCH_ENABLED</span> <span class="o">=</span>  <span class="kp">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sr">/**</span>
<span class="sr">     * Given an event, returns the horizontal location on the page on which</span>
<span class="sr">     * the event occurred.</span>
<span class="sr">     */</span>
    <span class="n">function</span> <span class="n">locationOfEvent</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">oEvent</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">originalEvent</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">oEvent</span><span class="o">.</span><span class="n">touches</span> <span class="o">&amp;&amp;</span> <span class="n">oEvent</span><span class="o">.</span><span class="n">touches</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">oEvent</span><span class="o">.</span><span class="n">touches</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">pageX</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">oEvent</span><span class="o">.</span><span class="n">changedTouches</span> <span class="o">&amp;&amp;</span> <span class="n">oEvent</span><span class="o">.</span><span class="n">changedTouches</span><span class="o">.</span><span class="n">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">oEvent</span><span class="o">.</span><span class="n">changedTouches</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">pageX</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">event</span><span class="o">.</span><span class="n">pageX</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="sr">/**</span>
<span class="sr">     * Determines to what minimum and maximum value the slider should be</span>
<span class="sr">     * drawn. Defaults to whatever minimum and maximum the user gave, but will</span>
<span class="sr">     * prefer an explicit &quot;drawTo&quot; option is one is provided.</span>
<span class="sr">     */</span>
    <span class="n">function</span> <span class="n">drawToOpts</span> <span class="p">(</span><span class="n">drawTo</span><span class="p">,</span> <span class="n">min</span><span class="p">,</span> <span class="n">max</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">drawTo</span> <span class="o">=</span> <span class="n">drawTo</span> <span class="o">||</span> <span class="p">{};</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="n">left</span><span class="p">:</span>  <span class="n">_</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">drawTo</span><span class="p">,</span> <span class="s1">&#39;left&#39;</span><span class="p">)</span>  <span class="p">?</span> <span class="n">drawTo</span><span class="o">.</span><span class="n">left</span>  <span class="p">:</span> <span class="n">min</span><span class="p">,</span>
            <span class="n">right</span><span class="p">:</span> <span class="n">_</span><span class="o">.</span><span class="n">has</span><span class="p">(</span><span class="n">drawTo</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="p">?</span> <span class="n">drawTo</span><span class="o">.</span><span class="n">right</span> <span class="p">:</span> <span class="n">max</span>
        <span class="p">};</span>
    <span class="p">}</span>

    <span class="sr">/**</span>
<span class="sr">     * When progressively enhancing an HTML input, this Quinn object&#39;s</span>
<span class="sr">     * &quot;wrapper&quot;, which is initially the input element, will be swapped with a</span>
<span class="sr">     * new &lt;div/</span><span class="o">&gt;</span> <span class="n">which</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">as</span> <span class="n">the</span> <span class="no">Quinn</span> <span class="n">element</span><span class="o">.</span>
     <span class="o">*/</span>
    <span class="n">function</span> <span class="n">createReplacementEl</span> <span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="err">$</span><span class="p">(</span><span class="s1">&#39;&lt;div /&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">css</span><span class="p">({</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span>   <span class="n">element</span><span class="o">.</span><span class="n">outerWidth</span><span class="p">(),</span>
            <span class="s1">&#39;margin&#39;</span><span class="p">:</span>  <span class="n">element</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;margin&#39;</span><span class="p">),</span>
            <span class="s1">&#39;display&#39;</span><span class="p">:</span> <span class="s1">&#39;inline-block&#39;</span><span class="p">,</span>
        <span class="p">});</span>
    <span class="p">}</span>

    <span class="sr">/**</span>
<span class="sr">     * When progressively-enhancing an HTML input, we need to use its min/m</span><span class="n">ax</span>
     <span class="o">*</span> <span class="n">values</span><span class="o">.</span> <span class="no">This</span> <span class="n">will</span> <span class="n">read</span> <span class="n">them</span><span class="p">,</span> <span class="n">falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">data</span><span class="o">-</span> <span class="n">attributes</span><span class="p">,</span> <span class="ow">or</span> <span class="n">the</span>
     <span class="o">*</span> <span class="no">Quinn</span> <span class="n">defaults</span><span class="o">.</span>
     <span class="o">*/</span>
    <span class="n">function</span> <span class="n">readInputAttribute</span> <span class="p">(</span><span class="n">el</span><span class="p">,</span> <span class="n">quinn</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">value</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">attr</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span> <span class="o">||</span> <span class="n">el</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;quinn-&#39;</span> <span class="o">+</span> <span class="n">attribute</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">parseFloat</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">quinn</span><span class="o">.</span><span class="n">options</span><span class="o">[</span><span class="n">attribute</span><span class="o">]</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="sr">/**</span>
<span class="sr">     * ## Quinn</span>
<span class="sr">     *</span>
<span class="sr">     * Quinn is the main slider class, and handles setting up the slider UI,</span>
<span class="sr">     * the element events, values, etc.</span>
<span class="sr">     *</span>
<span class="sr">     * `wrapper` is expected to be a DOM Element wrapped in a jQuery instance.</span>
<span class="sr">     * The slider will be placed into the wrapper element, respecting it&#39;s</span>
<span class="sr">     * width, padding etc.</span>
<span class="sr">     */</span>
    <span class="n">function</span> <span class="no">Quinn</span> <span class="p">(</span><span class="n">wrapper</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">opts</span><span class="p">;</span>

        <span class="n">_</span><span class="o">.</span><span class="n">bindAll</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="s1">&#39;clickBar&#39;</span><span class="p">,</span> <span class="s1">&#39;startDrag&#39;</span><span class="p">,</span> <span class="s1">&#39;drag&#39;</span><span class="p">,</span> <span class="s1">&#39;endDrag&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;handleKeyboardEvent&#39;</span><span class="p">,</span> <span class="s1">&#39;enableKeyboardEvents&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;disableKeyboardEvents&#39;</span><span class="p">);</span>

        <span class="n">this</span><span class="o">.</span><span class="n">wrapper</span>        <span class="o">=</span> <span class="n">wrapper</span><span class="p">;</span>
        <span class="n">this</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">opts</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">extend</span><span class="p">({},</span> <span class="no">Quinn</span><span class="o">.</span><span class="n">defaults</span><span class="p">,</span> <span class="n">options</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">callbacks</span>      <span class="o">=</span> <span class="p">{};</span>

        <span class="n">this</span><span class="o">.</span><span class="n">disabled</span>       <span class="o">=</span> <span class="kp">false</span><span class="p">;</span>
        <span class="n">this</span><span class="o">.</span><span class="n">activeHandle</span>   <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
        <span class="n">this</span><span class="o">.</span><span class="n">previousValue</span>  <span class="o">=</span> <span class="n">null</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">wrapper</span><span class="o">.</span><span class="n">is</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">enhance</span><span class="p">(</span><span class="n">wrapper</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="n">this</span><span class="o">.</span><span class="n">drawTo</span>         <span class="o">=</span> <span class="n">drawToOpts</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">drawTo</span><span class="p">,</span> <span class="n">opts</span><span class="o">.</span><span class="n">min</span><span class="p">,</span> <span class="n">opts</span><span class="o">.</span><span class="n">max</span><span class="p">);</span>

        <span class="n">this</span><span class="o">.</span><span class="n">model</span>          <span class="o">=</span> <span class="kp">new</span> <span class="no">Model</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">strict</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">renderer</span>       <span class="o">=</span> <span class="kp">new</span> <span class="n">this</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">renderer</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>

        <span class="n">this</span><span class="o">.</span><span class="n">keyFloodTimer</span>  <span class="o">=</span> <span class="n">null</span><span class="p">;</span>

        <span class="n">this</span><span class="o">.</span><span class="n">wrapperWidth</span>   <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">this</span><span class="o">.</span><span class="n">wrapperOffset</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="n">this</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;setup&#39;</span><span class="p">,</span>  <span class="n">opts</span><span class="o">.</span><span class="n">setup</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;begin&#39;</span><span class="p">,</span>  <span class="n">opts</span><span class="o">.</span><span class="n">begin</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;drag&#39;</span><span class="p">,</span>   <span class="n">opts</span><span class="o">.</span><span class="n">drag</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;change&#39;</span><span class="p">,</span> <span class="n">opts</span><span class="o">.</span><span class="n">change</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;abort&#39;</span><span class="p">,</span>  <span class="n">opts</span><span class="o">.</span><span class="n">abort</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">isFunction</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">disable</span> <span class="o">===</span> <span class="kp">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">disable</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="sr">//</span> <span class="no">Finish</span> <span class="n">off</span> <span class="n">by</span> <span class="n">triggering</span> <span class="n">the</span> <span class="n">setup</span> <span class="n">callback</span><span class="o">.</span>
        <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;setup&#39;</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sr">//</span> <span class="no">The</span> <span class="n">current</span> <span class="no">Quinn</span> <span class="n">version</span><span class="o">.</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">=</span> <span class="s1">&#39;1.0.5&#39;</span><span class="p">;</span>

    <span class="sr">//</span> <span class="c1">### Event Handling</span>

    <span class="sr">/**</span>
<span class="sr">     * ### on</span>
<span class="sr">     *</span>
<span class="sr">     * Binds a `callback` to be run whenever the given `event` occurs. Returns</span>
<span class="sr">     * the Quinn instance permitting chaining.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">on</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">callback</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">isString</span><span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">_</span><span class="o">.</span><span class="n">isFunction</span><span class="p">(</span><span class="n">callback</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">this</span><span class="o">.</span><span class="n">callbacks</span><span class="o">[</span><span class="n">event</span><span class="o">]</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">this</span><span class="o">.</span><span class="n">callbacks</span><span class="o">[</span><span class="n">event</span><span class="o">]</span> <span class="o">=</span> <span class="o">[]</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">this</span><span class="o">.</span><span class="n">callbacks</span><span class="o">[</span><span class="n">event</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">callback</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">this</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### trigger</span>
<span class="sr">     *</span>
<span class="sr">     * Runs the callbacks of the given evengt type.</span>
<span class="sr">     *</span>
<span class="sr">     * If any of the callbacks return false, other callbacks will not be run,</span>
<span class="sr">     * and trigger will return false; otherwise true is returned.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">trigger</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">callbacks</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">callbacks</span><span class="o">[</span><span class="n">event</span><span class="o">]</span> <span class="o">||</span> <span class="o">[]</span><span class="p">,</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">callback</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">===</span> <span class="n">void</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">while</span> <span class="p">(</span><span class="n">callback</span> <span class="o">=</span> <span class="n">callbacks</span><span class="o">[</span><span class="n">i</span><span class="o">++]</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">callback</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">this</span><span class="p">)</span> <span class="o">===</span> <span class="kp">false</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kp">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="kp">true</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="sr">//</span> <span class="c1">## Values, and Domain Logic</span>

    <span class="sr">/**</span>
<span class="sr">     * ### enable</span>
<span class="sr">     *</span>
<span class="sr">     * Enables the slider so that a user may change its value. Triggers the</span>
<span class="sr">     * &quot;enabled&quot; event unless the instance was already enabled.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">enable</span> <span class="o">=</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">disabled</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kp">false</span><span class="p">;</span>
            <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;enabled&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### disable</span>
<span class="sr">     *</span>
<span class="sr">     * Disables the slider so that a user may not change its value. Triggers</span>
<span class="sr">     * the &quot;disabled&quot; event unless the instance was already disabled.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">disable</span> <span class="o">=</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">this</span><span class="o">.</span><span class="n">disabled</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kp">true</span><span class="p">;</span>
            <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;disabled&#39;</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### setValue</span>
<span class="sr">     *</span>
<span class="sr">     * Updates the value of the slider to `newValue`. If the `animate`</span>
<span class="sr">     * argument is truthy, the change in value will be animated when updating</span>
<span class="sr">     * the slider position. The drag callback may be skipped if `silent` is</span>
<span class="sr">     * true.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">setValue</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">newValue</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">silent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">start</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">setTentativeValue</span><span class="p">(</span><span class="n">newValue</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">silent</span><span class="p">)</span> <span class="o">!==</span> <span class="kp">false</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">this</span><span class="o">.</span><span class="n">resolve</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">this</span><span class="o">.</span><span class="n">reject</span><span class="p">();</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### setTentativeValue</span>
<span class="sr">     *</span>
<span class="sr">     * Used internally to set the model value while ensuring that the</span>
<span class="sr">     * necessary callbacks are fired.</span>
<span class="sr">     *</span>
<span class="sr">     * See `setValue`.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">setTentativeValue</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">newValue</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">silent</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">preDragValue</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">prevScalar</span>   <span class="o">=</span> <span class="n">null</span><span class="p">,</span>
            <span class="n">nextScalar</span>   <span class="o">=</span> <span class="n">null</span><span class="p">,</span>
            <span class="n">scalar</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">typeof</span> <span class="n">newValue</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="n">newValue</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kp">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="sr">//</span> <span class="no">If</span> <span class="n">the</span> <span class="n">slider</span> <span class="n">is</span> <span class="n">a</span> <span class="n">range</span> <span class="p">(</span><span class="n">more</span> <span class="n">than</span> <span class="n">one</span> <span class="n">value</span><span class="p">),</span> <span class="n">but</span> <span class="n">only</span> <span class="n">a</span> <span class="n">number</span>
        <span class="sr">//</span> <span class="n">was</span> <span class="n">given</span><span class="p">,</span> <span class="n">we</span> <span class="n">need</span> <span class="n">to</span> <span class="n">alter</span> <span class="n">the</span> <span class="n">given</span> <span class="n">value</span> <span class="n">so</span> <span class="n">that</span> <span class="n">we</span> <span class="n">set</span> <span class="n">the</span>
        <span class="sr">//</span> <span class="n">other</span> <span class="n">values</span> <span class="n">also</span><span class="o">.</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">_</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="n">newValue</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">activeHandle</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="sr">//</span> <span class="no">Without</span> <span class="n">an</span> <span class="n">active</span> <span class="n">handle</span><span class="p">,</span> <span class="n">we</span> <span class="n">don</span><span class="s1">&#39;t know which value we are</span>
<span class="s1">                // supposed to set.</span>
<span class="s1">                return false;</span>
<span class="s1">            }</span>

<span class="s1">            scalar   = this.model.sanitizeValue(newValue);</span>
<span class="s1">            newValue = _.clone(this.model.values);</span>

<span class="s1">            // Ensure that the handle doesn&#39;</span><span class="n">t</span> <span class="s2">&quot;cross over&quot;</span> <span class="n">a</span> <span class="n">higher</span> <span class="ow">or</span>
            <span class="sr">//</span> <span class="n">lower</span> <span class="n">handle</span><span class="o">.</span>

            <span class="n">prevScalar</span> <span class="o">=</span> <span class="n">newValue</span><span class="o">[</span><span class="n">this</span><span class="o">.</span><span class="n">activeHandle</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]</span><span class="p">;</span>
            <span class="n">nextScalar</span> <span class="o">=</span> <span class="n">newValue</span><span class="o">[</span><span class="n">this</span><span class="o">.</span><span class="n">activeHandle</span> <span class="o">+</span> <span class="mi">1</span><span class="o">]</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">prevScalar</span> <span class="o">!==</span> <span class="n">null</span> <span class="o">&amp;&amp;</span> <span class="n">scalar</span> <span class="o">&lt;=</span> <span class="n">prevScalar</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">scalar</span> <span class="o">=</span> <span class="n">prevScalar</span> <span class="o">+</span> <span class="n">this</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">step</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">nextScalar</span> <span class="o">!==</span> <span class="n">null</span> <span class="o">&amp;&amp;</span> <span class="n">scalar</span> <span class="o">&gt;=</span> <span class="n">nextScalar</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">scalar</span> <span class="o">=</span> <span class="n">nextScalar</span> <span class="o">-</span> <span class="n">this</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">step</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">newValue</span><span class="o">[</span><span class="n">this</span><span class="o">.</span><span class="n">activeHandle</span><span class="o">]</span> <span class="o">=</span> <span class="n">scalar</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">newValue</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">newValue</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">newValue</span> <span class="o">===</span> <span class="kp">false</span> <span class="o">||</span>
                <span class="p">(</span><span class="o">!</span> <span class="n">silent</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;drag&#39;</span><span class="p">,</span> <span class="n">newValue</span><span class="p">)))</span> <span class="p">{</span>

            <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">preDragValue</span><span class="p">);</span>

            <span class="sr">//</span> <span class="no">If</span> <span class="n">the</span> <span class="n">drag</span> <span class="n">callback</span> <span class="n">failed</span><span class="p">,</span> <span class="n">we</span> <span class="n">need</span> <span class="n">to</span> <span class="nb">send</span> <span class="n">another</span> <span class="n">drag</span>
            <span class="sr">//</span> <span class="n">event</span> <span class="n">so</span> <span class="n">that</span> <span class="n">the</span> <span class="n">developer</span> <span class="n">has</span> <span class="n">the</span> <span class="n">chance</span> <span class="n">to</span> <span class="n">respond</span><span class="o">.</span>
            <span class="p">(</span><span class="n">newValue</span> <span class="o">!==</span> <span class="kp">false</span> <span class="o">&amp;&amp;</span> <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;drag&#39;</span><span class="p">,</span> <span class="n">preDragValue</span><span class="p">));</span>

            <span class="k">return</span> <span class="kp">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;redraw&#39;</span><span class="p">,</span> <span class="n">animate</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">newValue</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### stepUp</span>
<span class="sr">     *</span>
<span class="sr">     * Increases the value of the slider by `step`. Does nothing if the slider</span>
<span class="sr">     * is alredy at its maximum value.</span>
<span class="sr">     *</span>
<span class="sr">     * The optional argument is an integer which indicates the number of steps</span>
<span class="sr">     * by which to increase the value.</span>
<span class="sr">     *</span>
<span class="sr">     * Returns the new slider value</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">stepUp</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">tentative</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">func</span> <span class="o">=</span> <span class="p">(</span><span class="n">tentative</span> <span class="p">?</span> <span class="n">this</span><span class="o">.</span><span class="n">setTentativeValue</span> <span class="p">:</span> <span class="n">this</span><span class="o">.</span><span class="n">setValue</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="no">Cannot</span> <span class="n">step</span> <span class="n">a</span> <span class="n">range</span><span class="o">-</span><span class="n">based</span> <span class="n">slider</span><span class="o">.</span>
            <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">_</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">this</span><span class="p">)(</span>
            <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">step</span> <span class="o">*</span> <span class="p">(</span><span class="n">count</span> <span class="o">||</span> <span class="mi">1</span><span class="p">),</span> <span class="n">animate</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### stepDown</span>
<span class="sr">     *</span>
<span class="sr">     * Decreases the value of the slider by `step`. Does nothing if the slider</span>
<span class="sr">     * is alredy at its minimum value.</span>
<span class="sr">     *</span>
<span class="sr">     * The optional argument is an integer which indicates the number of steps</span>
<span class="sr">     * by which to decrease the value.</span>
<span class="sr">     *</span>
<span class="sr">     * Returns the new slider value</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">stepDown</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">animate</span><span class="p">,</span> <span class="n">tentative</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">stepUp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">count</span> <span class="o">||</span> <span class="mi">1</span><span class="p">),</span> <span class="n">animate</span><span class="p">,</span> <span class="n">tentative</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### start</span>
<span class="sr">     *</span>
<span class="sr">     * Tells the Quinn instance that the user is about to make a change to the</span>
<span class="sr">     * slider value. The calling function should check the return value of</span>
<span class="sr">     * start -- if false, no changes are permitted to the slider.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">disabled</span> <span class="o">===</span> <span class="kp">true</span> <span class="o">||</span> <span class="o">!</span> <span class="n">this</span><span class="o">.</span><span class="n">trigger</span><span class="p">(</span><span class="s1">&#39;begin&#39;</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kp">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">this</span><span class="o">.</span><span class="n">previousValue</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>

        <span class="sr">//</span> <span class="no">These</span> <span class="n">attributes</span> <span class="n">are</span> <span class="n">cached</span> <span class="n">so</span> <span class="n">that</span> <span class="n">we</span> <span class="n">don</span><span class="s1">&#39;t have to look them up</span>
<span class="s1">        // every time the user drags the handle.</span>
<span class="s1">        this.wrapperWidth  = this.wrapper.width();</span>
<span class="s1">        this.wrapperOffset = this.wrapper.offset().left;</span>

<span class="s1">        return true;</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### resolve</span>
<span class="s1">     *</span>
<span class="s1">     * Tells the Quinn instance that the user has finished making their</span>
<span class="s1">     * changes to the slider and that the new value should be retained.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.resolve = function () {</span>
<span class="s1">        this.deactivateActiveHandle();</span>

<span class="s1">        if (_.isEqual(this.previousValue, this.model.value)) {</span>
<span class="s1">            // The user reset the slider back to where it was.</span>
<span class="s1">            this.reject();</span>
<span class="s1">            return false;</span>
<span class="s1">        }</span>

<span class="s1">        /* Run the change callback; if the callback returns false then we</span>
<span class="s1">         * revert the slider change, and restore everything to how it was</span>
<span class="s1">         * before. Note that reverting the change will also fire an change</span>
<span class="s1">         * event when the value is reverted.</span>
<span class="s1">         */</span>
<span class="s1">        if (! this.trigger(&#39;</span><span class="n">change</span><span class="s1">&#39;, this.model.value)) {</span>
<span class="s1">            this.setTentativeValue(this.previousValue);</span>
<span class="s1">            this.reject();</span>

<span class="s1">            return false;</span>
<span class="s1">        }</span>

<span class="s1">        this.previousValue = null;</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### reject</span>
<span class="s1">     *</span>
<span class="s1">     * Aborts a slider change.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.reject = function () {</span>
<span class="s1">        this.previousValue = null;</span>
<span class="s1">        this.deactivateActiveHandle();</span>

<span class="s1">        return this.trigger(&#39;</span><span class="nb">abort</span><span class="s1">&#39;);</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### valueFromMouse</span>
<span class="s1">     *</span>
<span class="s1">     * Determines the value of the slider at the position indicated by the</span>
<span class="s1">     * mouse cursor.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.valueFromMouse = function (mousePosition) {</span>
<span class="s1">        var percent = this.positionFromMouse(mousePosition),</span>
<span class="s1">            delta   = this.drawTo.right - this.drawTo.left;</span>

<span class="s1">        return this.drawTo.left + delta * percent;</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### positionFromMouse</span>
<span class="s1">     *</span>
<span class="s1">     * Determines how far along the bar the mouse cursor is as a fraction of</span>
<span class="s1">     * the bar&#39;</span><span class="n">s</span> <span class="n">width</span><span class="o">.</span>
     <span class="o">*</span>
     <span class="o">*</span> <span class="no">TODO</span> <span class="no">Cache</span> <span class="n">the</span> <span class="n">width</span> <span class="ow">and</span> <span class="n">offset</span> <span class="k">when</span> <span class="n">the</span> <span class="n">drag</span> <span class="n">operation</span> <span class="n">begins</span><span class="o">.</span>
     <span class="o">*/</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">positionFromMouse</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">mousePosition</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">maxRight</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">wrapperOffset</span> <span class="o">+</span> <span class="n">this</span><span class="o">.</span><span class="n">wrapperWidth</span><span class="p">,</span>
            <span class="n">barPosition</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">mousePosition</span> <span class="o">&lt;</span> <span class="n">this</span><span class="o">.</span><span class="n">wrapperOffset</span><span class="p">)</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="no">Mouse</span> <span class="n">is</span> <span class="n">to</span> <span class="n">the</span> <span class="n">left</span> <span class="n">of</span> <span class="n">the</span> <span class="n">bar</span><span class="o">.</span>
            <span class="n">barPosition</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">mousePosition</span> <span class="o">&gt;</span> <span class="n">maxRight</span><span class="p">)</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="no">Mouse</span> <span class="n">is</span> <span class="n">to</span> <span class="n">the</span> <span class="n">right</span> <span class="n">of</span> <span class="n">the</span> <span class="n">bar</span><span class="o">.</span>
            <span class="n">barPosition</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">wrapperWidth</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">barPosition</span> <span class="o">=</span> <span class="n">mousePosition</span> <span class="o">-</span> <span class="n">this</span><span class="o">.</span><span class="n">wrapperOffset</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">barPosition</span> <span class="o">/</span> <span class="n">this</span><span class="o">.</span><span class="n">wrapperWidth</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="sr">//</span> <span class="c1">## User Interaction</span>

    <span class="sr">/**</span>
<span class="sr">     * ### startDrag</span>
<span class="sr">     *</span>
<span class="sr">     * Begins a drag event which permits a user to move the slider handle in</span>
<span class="sr">     * order to adjust the slider value.</span>
<span class="sr">     *</span>
<span class="sr">     * When `skipPreamble` is true, startDrag will not run `start()` on the</span>
<span class="sr">     * assumption that it has already been run (see `clickBar`).</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">startDrag</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">skipPreamble</span><span class="p">)</span> <span class="p">{</span>
        <span class="sr">//</span> <span class="no">Only</span> <span class="n">enable</span> <span class="n">dragging</span> <span class="k">when</span> <span class="n">the</span> <span class="n">left</span> <span class="n">mouse</span> <span class="n">button</span> <span class="n">is</span> <span class="n">used</span><span class="o">.</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="no">IS_TOUCH_ENABLED</span> <span class="o">&amp;&amp;</span> <span class="n">event</span><span class="o">.</span><span class="n">which</span> <span class="o">!==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kp">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">skipPreamble</span> <span class="o">&amp;&amp;</span> <span class="o">!</span> <span class="n">this</span><span class="o">.</span><span class="n">start</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kp">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">this</span><span class="o">.</span><span class="n">activateHandleWithEvent</span><span class="p">(</span><span class="n">event</span><span class="p">);</span>

        <span class="sr">//</span> <span class="no">These</span> <span class="n">events</span> <span class="n">are</span> <span class="n">bound</span> <span class="k">for</span> <span class="n">the</span> <span class="n">duration</span> <span class="n">of</span> <span class="n">the</span> <span class="n">drag</span> <span class="n">operation</span> <span class="ow">and</span>
        <span class="sr">//</span> <span class="n">keep</span> <span class="n">track</span> <span class="n">of</span> <span class="n">the</span> <span class="n">value</span> <span class="n">changes</span> <span class="n">made</span><span class="p">,</span> <span class="n">with</span> <span class="n">the</span> <span class="n">events</span> <span class="n">being</span> <span class="n">removed</span>
        <span class="sr">//</span> <span class="k">when</span> <span class="n">the</span> <span class="n">mouse</span> <span class="n">button</span> <span class="n">is</span> <span class="n">released</span><span class="o">.</span>
        <span class="err">$</span><span class="p">(</span><span class="n">document</span><span class="p">)</span><span class="o">.</span>
            <span class="n">on</span><span class="p">(</span><span class="no">DRAG_END_E</span> <span class="o">+</span> <span class="s1">&#39;.quinn&#39;</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">endDrag</span><span class="p">)</span><span class="o">.</span>
            <span class="n">on</span><span class="p">(</span><span class="no">DRAG_E</span>     <span class="o">+</span> <span class="s1">&#39;.quinn&#39;</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">drag</span><span class="p">)</span><span class="o">.</span>

            <span class="sr">//</span> <span class="no">The</span> <span class="n">mouse</span> <span class="n">may</span> <span class="n">leave</span> <span class="n">the</span> <span class="n">window</span> <span class="k">while</span> <span class="n">dragging</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">mouse</span>
            <span class="sr">//</span> <span class="n">button</span> <span class="n">released</span><span class="o">.</span> <span class="no">Watch</span> <span class="k">for</span> <span class="n">the</span> <span class="n">mouse</span> <span class="n">re</span><span class="o">-</span><span class="n">entering</span><span class="p">,</span> <span class="ow">and</span> <span class="n">see</span> <span class="n">what</span>
            <span class="sr">//</span> <span class="n">the</span> <span class="n">button</span> <span class="n">is</span> <span class="n">doing</span><span class="o">.</span>
            <span class="n">on</span><span class="p">(</span><span class="s1">&#39;mouseenter.quinn&#39;</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">endDrag</span><span class="p">);</span>

        <span class="k">return</span> <span class="kp">false</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### drag</span>
<span class="sr">     *</span>
<span class="sr">     * Bound to the mousemove event, alters the slider value while the user</span>
<span class="sr">     * contiues to hold the left mouse button.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">drag</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">this</span><span class="o">.</span><span class="n">setTentativeValue</span><span class="p">(</span>
            <span class="n">this</span><span class="o">.</span><span class="n">valueFromMouse</span><span class="p">(</span><span class="n">locationOfEvent</span><span class="p">(</span><span class="n">event</span><span class="p">)),</span> <span class="kp">false</span><span class="p">);</span>

        <span class="k">return</span> <span class="n">event</span><span class="o">.</span><span class="n">preventDefault</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### endDrag</span>
<span class="sr">     *</span>
<span class="sr">     * Run when the user lifts the mouse button after completing a drag.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">endDrag</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="sr">//</span> <span class="no">Remove</span> <span class="n">the</span> <span class="n">events</span> <span class="n">which</span> <span class="n">were</span> <span class="n">bound</span> <span class="k">in</span> <span class="sb">`startDrag`</span><span class="o">.</span>
        <span class="err">$</span><span class="p">(</span><span class="n">document</span><span class="p">)</span><span class="o">.</span>
            <span class="n">off</span><span class="p">(</span><span class="no">DRAG_END_E</span> <span class="o">+</span> <span class="s1">&#39;.quinn&#39;</span><span class="p">)</span><span class="o">.</span>
            <span class="n">off</span><span class="p">(</span><span class="no">DRAG_E</span> <span class="o">+</span> <span class="s1">&#39;.quinn&#39;</span><span class="p">)</span><span class="o">.</span>
            <span class="n">off</span><span class="p">(</span><span class="s1">&#39;mouseenter.quinn&#39;</span><span class="p">);</span>

        <span class="n">this</span><span class="o">.</span><span class="n">resolve</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">event</span><span class="o">.</span><span class="n">preventDefault</span><span class="p">();</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### clickBar</span>
<span class="sr">     *</span>
<span class="sr">     * Event handler which is used when the user clicks part of the slider bar</span>
<span class="sr">     * to instantly change the value.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">clickBar</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="sr">//</span> <span class="no">Ignore</span> <span class="n">the</span> <span class="n">click</span> <span class="k">if</span> <span class="n">the</span> <span class="n">left</span> <span class="n">mouse</span> <span class="n">button</span> <span class="n">wasn</span><span class="s1">&#39;t used.</span>
<span class="s1">        if (! IS_TOUCH_ENABLED &amp;&amp; event.which !== 1) {</span>
<span class="s1">            return true;</span>
<span class="s1">        }</span>

<span class="s1">        if (this.start()) {</span>
<span class="s1">            this.activateHandleWithEvent(event);</span>
<span class="s1">            this.setTentativeValue(</span>
<span class="s1">                this.valueFromMouse(locationOfEvent(event)));</span>
<span class="s1">            this.startDrag(event, true);</span>
<span class="s1">        }</span>

<span class="s1">        return event.preventDefault();</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * Given a click or drag event, determines which model &quot;value&quot; is closest</span>
<span class="s1">     * to the clicked location and tells the view to activate the handle.</span>
<span class="s1">     * Does nothing if a handle is already active.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.activateHandleWithEvent = function (event) {</span>
<span class="s1">        var value, closestValue, handleIndex;</span>

<span class="s1">        if (this.activeHandle) {</span>
<span class="s1">            return false;</span>
<span class="s1">        }</span>

<span class="s1">        value = this.valueFromMouse(locationOfEvent(event));</span>

<span class="s1">        closestValue = _.min(this.model.values, function (handleValue) {</span>
<span class="s1">            return Math.abs(handleValue - value);</span>
<span class="s1">        });</span>

<span class="s1">        handleIndex = _.indexOf(this.model.values, closestValue);</span>

<span class="s1">        if (handleIndex !== -1) {</span>
<span class="s1">            this.activeHandle = handleIndex;</span>
<span class="s1">            this.trigger(&#39;</span><span class="n">handleOn</span><span class="s1">&#39;, this.activeHandle);</span>
<span class="s1">        }</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * Deactivates the currently active handle. Does nothing if no handle is</span>
<span class="s1">     * active.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.deactivateActiveHandle = function () {</span>
<span class="s1">        if (this.activeHandle !== null &amp;&amp; this.activeHandle !== -1) {</span>
<span class="s1">            this.trigger(&#39;</span><span class="n">handleOff</span><span class="s1">&#39;, this.activeHandle);</span>
<span class="s1">            this.activeHandle = null;</span>
<span class="s1">        }</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * When an handle is focused, allows left/right to change the value.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.enableKeyboardEvents = function (event) {</span>
<span class="s1">        $(event.target).on(&#39;</span><span class="n">keydown</span><span class="s1">&#39;, this.handleKeyboardEvent);</span>
<span class="s1">        $(event.target).on(&#39;</span><span class="n">keyup</span><span class="s1">&#39;,   this.handleKeyboardEvent);</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * Unsets keyboard event handlers after the handle is blurred.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.disableKeyboardEvents = function (event) {</span>
<span class="s1">        $(event.target).off(&#39;</span><span class="n">keydown</span><span class="s1">&#39;, this.handleKeyboardEvent);</span>
<span class="s1">        $(event.target).off(&#39;</span><span class="n">keyup</span><span class="s1">&#39;,   this.handleKeyboardEvent);</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * Receives events from the keyboard and adjusts the Quinn value.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.handleKeyboardEvent = function (event) {</span>
<span class="s1">        if (event.type === &#39;</span><span class="n">keydown</span><span class="s1">&#39;) {</span>
<span class="s1">            if (this.keyFloodTimer) {</span>
<span class="s1">                window.clearTimeout(this.keyFloodTimer);</span>
<span class="s1">                this.keyFloodTimer = null;</span>
<span class="s1">            }</span>

<span class="s1">            if (this.previousValue == null &amp;&amp; ! this.start()) {</span>
<span class="s1">                return false;</span>
<span class="s1">            }</span>
<span class="s1">        } else if (event.type === &#39;</span><span class="n">keyup</span><span class="s1">&#39;) {</span>
<span class="s1">            if (this.previousValue != null) {</span>
<span class="s1">                if (this.options.keyFloodWait) {</span>
<span class="s1">                    // Prevent multiple successive keydowns from repeatedly</span>
<span class="s1">                    // triggering resolve.</span>
<span class="s1">                    this.keyFloodTimer = window.setTimeout(</span>
<span class="s1">                        _.bind(this.resolve, this),</span>
<span class="s1">                        this.options.keyFloodWait);</span>
<span class="s1">                } else {</span>
<span class="s1">                    this.resolve();</span>
<span class="s1">                }</span>
<span class="s1">            }</span>

<span class="s1">            return true;</span>
<span class="s1">        }</span>

<span class="s1">        switch (event.which) {</span>
<span class="s1">            case 33: // Page up.</span>
<span class="s1">                this.stepUp(10, false, true); break;</span>
<span class="s1">            case 34: // Page down.</span>
<span class="s1">                this.stepDown(10, false, true); break;</span>
<span class="s1">            case 37: // Left arrow.</span>
<span class="s1">            case 40: // Down arrow.</span>
<span class="s1">                if (event.metaKey) {</span>
<span class="s1">                    this.setTentativeValue(this.model.minimum, false);</span>
<span class="s1">                } else {</span>
<span class="s1">                    this.stepDown(event.altKey ? 10 : 1, false, true);</span>
<span class="s1">                }</span>
<span class="s1">                break;</span>
<span class="s1">            case 39: // Right arrow.</span>
<span class="s1">            case 38: // Up arrow.</span>
<span class="s1">                if (event.metaKey) {</span>
<span class="s1">                    this.setTentativeValue(this.model.maximum, false);</span>
<span class="s1">                } else {</span>
<span class="s1">                    this.stepUp(event.altKey ? 10 : 1, false, true);</span>
<span class="s1">                }</span>
<span class="s1">                break;</span>
<span class="s1">            default:</span>
<span class="s1">                return true;</span>
<span class="s1">        }</span>

<span class="s1">        event.preventDefault();</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * Used during initialization to progressively-enhance an existing HTML</span>
<span class="s1">     * input, instead of simply drawing into a &lt;div/&gt;.</span>
<span class="s1">     *</span>
<span class="s1">     * Afters the Quinn options, renders the replacement elements in the DOM,</span>
<span class="s1">     * and sets up events to send the value back-and-forth between Quinn and the</span>
<span class="s1">     * original input element.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.prototype.enhance = function (element) {</span>
<span class="s1">        this.options.disabled = element.attr(&#39;</span><span class="n">disabled</span><span class="s1">&#39;);</span>
<span class="s1">        this.options.step     = readInputAttribute(element, this, &#39;</span><span class="n">step</span><span class="s1">&#39;);</span>
<span class="s1">        this.options.value    = readInputAttribute(element, this, &#39;</span><span class="n">value</span><span class="s1">&#39;);</span>
<span class="s1">        this.options.min      = readInputAttribute(element, this, &#39;</span><span class="n">min</span><span class="s1">&#39;);</span>
<span class="s1">        this.options.max      = readInputAttribute(element, this, &#39;</span><span class="n">max</span><span class="s1">&#39;);</span>

<span class="s1">        this.wrapper = createReplacementEl(element).insertAfter(element.hide());</span>

<span class="s1">        this.on(&#39;</span><span class="n">change</span><span class="s1">&#39;, function (value) { element.val(value) });</span>

<span class="s1">        element.on(&#39;</span><span class="n">change</span><span class="s1">&#39;, _.bind(function (event) {</span>
<span class="s1">            this.setValue(element.val());</span>
<span class="s1">        }, this));</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ## Model</span>
<span class="s1">     *</span>
<span class="s1">     * Holds the current Quinn value, ensures that the value set is valid</span>
<span class="s1">     * (within the `range` bounds, one of the `only` values, etc).</span>
<span class="s1">     */</span>
<span class="s1">    function Model (quinn, initiallyStrict) {</span>
<span class="s1">        var opts, initialValue, length, i;</span>

<span class="s1">        this.options = opts = quinn.options;</span>
<span class="s1">        this.step    = opts.step;</span>
<span class="s1">        this.only    = opts.only;</span>
<span class="s1">        this.values  = [];</span>

<span class="s1">        /* The minimum and maximum need to be &quot;fixed&quot; so that they are a</span>
<span class="s1">         * multiple of the &quot;step&quot; option. For example, if given a step of 5</span>
<span class="s1">         * then we must round a minimum value of 2 up to 5, and a maximum</span>
<span class="s1">         * value of 97 down to 95.</span>
<span class="s1">         *</span>
<span class="s1">         * Note that values are always rounded so that they stay within the</span>
<span class="s1">         * given minimum and maximum range. 2 cannot be rounded down to 0,</span>
<span class="s1">         * since that is lower than the value provided by the user.</span>
<span class="s1">         *</span>
<span class="s1">         * TODO Provided this.min and this.max are set, isn&#39;</span><span class="n">t</span> <span class="n">it</span> <span class="n">possible</span>
         <span class="o">*</span>      <span class="n">to</span> <span class="n">just</span> <span class="n">use</span> <span class="n">sanitizeValue?</span>
         <span class="o">*/</span>

        <span class="n">this</span><span class="o">.</span><span class="n">minimum</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">roundToStep</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">min</span><span class="p">);</span>
        <span class="n">this</span><span class="o">.</span><span class="n">maximum</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">roundToStep</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">max</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">minimum</span> <span class="o">&lt;</span> <span class="n">opts</span><span class="o">.</span><span class="n">min</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">minimum</span> <span class="o">+=</span> <span class="n">this</span><span class="o">.</span><span class="n">step</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">maximum</span> <span class="o">&gt;</span> <span class="n">opts</span><span class="o">.</span><span class="n">max</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">maximum</span> <span class="o">-=</span> <span class="n">this</span><span class="o">.</span><span class="n">step</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="sr">/* Determine the initial value of the slider. Prefer an explicitly set</span>
<span class="sr">         * value, whether a scalar or an array. If no value is provided by the</span>
<span class="sr">         * developer, instead fall back to using the minimum.</span>
<span class="sr">         */</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">typeof</span> <span class="n">opts</span><span class="o">.</span><span class="n">value</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span> <span class="o">||</span> <span class="n">opts</span><span class="o">.</span><span class="n">value</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">initialValue</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">minimum</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">isArray</span><span class="p">(</span><span class="n">opts</span><span class="o">.</span><span class="n">value</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">initialValue</span> <span class="o">=</span> <span class="n">opts</span><span class="o">.</span><span class="n">value</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">initialValue</span> <span class="o">=</span> <span class="o">[</span> <span class="n">opts</span><span class="o">.</span><span class="n">value</span> <span class="o">]</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">initialValue</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">values</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">this</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">initialValue</span><span class="p">,</span> <span class="n">initiallyStrict</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="sr">/**</span>
<span class="sr">     * An internal method which sets the value of the slider during a drag</span>
<span class="sr">     * event. `setValue` should be called only after `start` in the Quinn</span>
<span class="sr">     * instance.</span>
<span class="sr">     *</span>
<span class="sr">     * Only when `resolve` is called is the value considered final. If</span>
<span class="sr">     * `reject` is called, the tentative value is discarded and the</span>
<span class="sr">     * previous &quot;good&quot; value is restored.</span>
<span class="sr">     *</span>
<span class="sr">     * The new value will be returned (which may differ slightly from the</span>
<span class="sr">     * value you set, if it had to be adjusted to fit the step option, or stay</span>
<span class="sr">     * within the minimum /</span> <span class="n">maximum</span> <span class="n">range</span><span class="p">)</span><span class="o">.</span> <span class="no">The</span> <span class="nb">method</span> <span class="n">will</span> <span class="k">return</span> <span class="kp">false</span> <span class="k">if</span>
     <span class="o">*</span> <span class="n">the</span> <span class="n">value</span> <span class="n">you</span> <span class="n">set</span> <span class="n">resulted</span> <span class="k">in</span> <span class="n">no</span> <span class="n">changes</span><span class="o">.</span>
     <span class="o">*/</span>
    <span class="no">Model</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">setValue</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">newValue</span><span class="p">,</span> <span class="n">strict</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">originalValue</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">i</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">_</span><span class="o">.</span><span class="n">isArray</span><span class="p">(</span><span class="n">newValue</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">newValue</span> <span class="o">=</span> <span class="o">[</span> <span class="n">newValue</span> <span class="o">]</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="no">Don</span><span class="s1">&#39;t mutate the original array.</span>
<span class="s1">            newValue = _.clone(newValue);</span>
<span class="s1">        }</span>

<span class="s1">        for (i = 0, length = newValue.length; i &lt; length; i++) {</span>
<span class="s1">            newValue[i] = this.sanitizeValue(newValue[i], strict);</span>
<span class="s1">        }</span>

<span class="s1">        if (_.isEqual(newValue, originalValue)) {</span>
<span class="s1">            return false;</span>
<span class="s1">        }</span>

<span class="s1">        this.value = this.values = newValue;</span>

<span class="s1">        if (this.values.length === 1) {</span>
<span class="s1">            // When the slider represents only a single value, instead of</span>
<span class="s1">            // setting an array as the value, just use the number.</span>
<span class="s1">            this.value = newValue[0];</span>
<span class="s1">        }</span>

<span class="s1">        return this.value;</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### roundToStep</span>
<span class="s1">     *</span>
<span class="s1">     * Given a number, rounds it to the nearest step.</span>
<span class="s1">     *</span>
<span class="s1">     * For example, if options.step is 5, given 4 will round to 5. Given</span>
<span class="s1">     * 2 will round to 0, etc. Does not take account of the minimum and</span>
<span class="s1">     * maximum range options.</span>
<span class="s1">     */</span>
<span class="s1">    Model.prototype.roundToStep = function (number) {</span>
<span class="s1">        var multiplier = 1 / this.step,</span>
<span class="s1">            rounded    = Math.round(number * multiplier) / multiplier;</span>

<span class="s1">        if (_.isArray(this.only)) {</span>
<span class="s1">            rounded = _.min(this.only, function (value) {</span>
<span class="s1">                return Math.abs(value - number);</span>
<span class="s1">            });</span>
<span class="s1">        }</span>

<span class="s1">        if (rounded &gt; this.maximum) {</span>
<span class="s1">            return rounded - this.step;</span>
<span class="s1">        } else if (rounded &lt; this.minimum) {</span>
<span class="s1">            return rounded + this.step;</span>
<span class="s1">        }</span>

<span class="s1">        return rounded;</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### sanitizeValue</span>
<span class="s1">     *</span>
<span class="s1">     * Given a numberic value, snaps it to the nearest step, and ensures that</span>
<span class="s1">     * it is within the selectable minima and maxima.</span>
<span class="s1">     */</span>
<span class="s1">    Model.prototype.sanitizeValue = function (value, strict) {</span>
<span class="s1">        if (strict !== false) {</span>
<span class="s1">            value = this.roundToStep(value);</span>
<span class="s1">        }</span>

<span class="s1">        if (value &gt; this.maximum) {</span>
<span class="s1">            return this.maximum;</span>
<span class="s1">        } else if (value &lt; this.minimum) {</span>
<span class="s1">            return this.minimum;</span>
<span class="s1">        }</span>

<span class="s1">        return value;</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ## Renderer</span>
<span class="s1">     *</span>
<span class="s1">     * Handles creation of the DOM nodes used by Quinn, as well as redrawing</span>
<span class="s1">     * those elements when the slider value is changed.</span>
<span class="s1">     *</span>
<span class="s1">     * You may write your own renderer class and provide it to Quinn using the</span>
<span class="s1">     * `renderer: myRenderer` option.</span>
<span class="s1">     *</span>
<span class="s1">     * Your class needs to define only two public methods:</span>
<span class="s1">     *</span>
<span class="s1">     * render:</span>
<span class="s1">     *   Creates the DOM elements for displaying the slider, and inserts them</span>
<span class="s1">     *   into the tree.</span>
<span class="s1">     *</span>
<span class="s1">     * redraw:</span>
<span class="s1">     *   Alters DOM elements (normally CSS) so that the visual representation</span>
<span class="s1">     *   of the slider matches the value.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.Renderer = function (quinn) {</span>
<span class="s1">        _.bindAll(this, &#39;</span><span class="n">render</span><span class="s1">&#39;, &#39;</span><span class="n">redraw</span><span class="s1">&#39;);</span>

<span class="s1">        var self = this;</span>

<span class="s1">        this.quinn    = quinn;</span>
<span class="s1">        this.model    = quinn.model;</span>
<span class="s1">        this.wrapper  = quinn.wrapper;</span>
<span class="s1">        this.options  = quinn.options;</span>
<span class="s1">        this.handles  = [];</span>
<span class="s1">        this.lastDraw = [];</span>

<span class="s1">        quinn.on(&#39;</span><span class="n">redraw</span><span class="s1">&#39;, this.redraw);</span>

<span class="s1">        quinn.on(&#39;</span><span class="n">handleOn</span><span class="s1">&#39;, function (handleIndex) {</span>
<span class="s1">            self.handles[handleIndex].addClass(&#39;</span><span class="n">active</span><span class="s1">&#39;);</span>
<span class="s1">        });</span>

<span class="s1">        quinn.on(&#39;</span><span class="n">handleOff</span><span class="s1">&#39;, function (handleIndex) {</span>
<span class="s1">            self.handles[handleIndex].removeClass(&#39;</span><span class="n">active</span><span class="s1">&#39;);</span>
<span class="s1">        });</span>

<span class="s1">        quinn.on(&#39;</span><span class="n">enabled</span><span class="s1">&#39;, function () {</span>
<span class="s1">            self.wrapper.removeClass(&#39;</span><span class="n">disabled</span><span class="s1">&#39;);</span>

<span class="s1">            if (self.options.disabledOpacity !== 1.0) {</span>
<span class="s1">                self.wrapper.css(&#39;</span><span class="n">opacity</span><span class="s1">&#39;, 1.0);</span>
<span class="s1">            }</span>
<span class="s1">        });</span>

<span class="s1">        quinn.on(&#39;</span><span class="n">disabled</span><span class="s1">&#39;, function () {</span>
<span class="s1">            self.wrapper.addClass(&#39;</span><span class="n">disabled</span><span class="s1">&#39;);</span>

<span class="s1">            if (self.options.disabledOpacity !== 1.0) {</span>
<span class="s1">                self.wrapper.css(&#39;</span><span class="n">opacity</span><span class="s1">&#39;, self.options.disabledOpacity);</span>
<span class="s1">            }</span>
<span class="s1">        });</span>
<span class="s1">    };</span>

<span class="s1">    /**</span>
<span class="s1">     * ### render</span>
<span class="s1">     *</span>
<span class="s1">     * Quinn is initialized with an empty wrapper element; render adds the</span>
<span class="s1">     * necessary DOM elements in order to display the slider UI.</span>
<span class="s1">     *</span>
<span class="s1">     * render() is called automatically when creating a new Quinn instance.</span>
<span class="s1">     */</span>
<span class="s1">    Quinn.Renderer.prototype.render = function () {</span>
<span class="s1">        var i, length, marginLeft;</span>

<span class="s1">        this.width = this.wrapper.width();</span>

<span class="s1">        function addRoundingElements (element) {</span>
<span class="s1">            element.append($(&#39;</span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;left&quot;</span> <span class="sr">/&gt;&#39;));</span>
<span class="sr">            element.append($(&#39;&lt;div class=&quot;main&quot; /</span><span class="o">&gt;</span><span class="s1">&#39;));</span>
<span class="s1">            element.append($(&#39;</span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;right&quot;</span> <span class="sr">/&gt;&#39;));</span>
<span class="sr">        }</span>

<span class="sr">        this.bar      = $(&#39;&lt;div class=&quot;bar&quot; /</span><span class="o">&gt;</span><span class="s1">&#39;);</span>
<span class="s1">        this.deltaBar = $(&#39;</span><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;delta-bar&quot;</span> <span class="sr">/&gt;&#39;);</span>

<span class="sr">        if (this.model.values.length &gt; 1) {</span>
<span class="sr">            this.wrapper.addClass(&#39;multiple&#39;);</span>
<span class="sr">        }</span>

<span class="sr">        addRoundingElements(this.bar);</span>

<span class="sr">        if (this.model.values.length &lt;= 2) {</span>
<span class="sr">            addRoundingElements(this.deltaBar);</span>
<span class="sr">            this.bar.append(this.deltaBar);</span>
<span class="sr">        }</span>

<span class="sr">        this.wrapper.html(this.bar);</span>
<span class="sr">        this.wrapper.addClass(&#39;quinn&#39;);</span>

<span class="sr">        /</span><span class="o">/</span> <span class="no">Add</span> <span class="n">each</span> <span class="n">of</span> <span class="n">the</span> <span class="n">handles</span> <span class="n">to</span> <span class="n">the</span> <span class="n">bar</span><span class="p">,</span> <span class="ow">and</span> <span class="n">bind</span> <span class="n">the</span> <span class="n">click</span> <span class="n">events</span><span class="o">.</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">length</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="err">$</span><span class="p">(</span><span class="s1">&#39;&lt;span class=&quot;handle&quot; tabindex=&quot;0&quot;&gt;&lt;/span&gt;&#39;</span><span class="p">);</span>

            <span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="n">on</span><span class="p">(</span><span class="no">DRAG_START_E</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">startDrag</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">enableKeyboardEvents</span><span class="p">);</span>
                <span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;blur&#39;</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">disableKeyboardEvents</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="n">this</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="sr">//</span> <span class="no">Finally</span><span class="p">,</span> <span class="n">these</span> <span class="n">events</span> <span class="n">are</span> <span class="n">triggered</span> <span class="k">when</span> <span class="n">the</span> <span class="n">user</span> <span class="n">seeks</span> <span class="n">to</span>
        <span class="sr">//</span> <span class="n">update</span> <span class="n">the</span> <span class="n">slider</span><span class="o">.</span>
        <span class="n">this</span><span class="o">.</span><span class="n">wrapper</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="no">DRAG_START_E</span><span class="p">,</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">clickBar</span><span class="p">);</span>

        <span class="n">this</span><span class="o">.</span><span class="n">barHeight</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">bar</span><span class="o">.</span><span class="n">height</span><span class="p">();</span>

        <span class="sr">//</span> <span class="no">If</span> <span class="n">the</span> <span class="n">handles</span> <span class="n">have</span> <span class="n">left</span> <span class="ow">and</span> <span class="n">right</span> <span class="n">margins</span><span class="p">,</span> <span class="n">it</span> <span class="n">indicates</span> <span class="n">that</span> <span class="n">the</span>
        <span class="sr">//</span> <span class="n">user</span> <span class="n">wants</span> <span class="n">the</span> <span class="n">handle</span> <span class="n">to</span> <span class="s2">&quot;overhang&quot;</span> <span class="n">the</span> <span class="n">edges</span> <span class="n">of</span> <span class="n">the</span> <span class="n">bar</span><span class="o">.</span> <span class="no">We</span> <span class="n">have</span> <span class="n">to</span>
        <span class="sr">//</span> <span class="n">account</span> <span class="k">for</span> <span class="n">this</span> <span class="k">when</span> <span class="n">positioning</span> <span class="n">the</span> <span class="n">handles</span><span class="o">.</span>
        <span class="n">this</span><span class="o">.</span><span class="n">handleOverhang</span> <span class="o">=</span>
            <span class="n">parseInt</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;margin-left&#39;</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">parseInt</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;margin-right&#39;</span><span class="p">),</span> <span class="mi">10</span><span class="p">);</span>

        <span class="n">this</span><span class="o">.</span><span class="n">redraw</span><span class="p">(</span><span class="kp">false</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### redraw</span>
<span class="sr">     *</span>
<span class="sr">     * Moves the slider handle and the delta-bar background elements so that</span>
<span class="sr">     * they accurately represent the value of the slider.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">Renderer</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">redraw</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">animate</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="nb">self</span> <span class="o">=</span> <span class="n">this</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">animate</span> <span class="o">!==</span> <span class="kp">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">animate</span> <span class="o">=</span> <span class="kp">true</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">_</span><span class="o">.</span><span class="n">each</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">function</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">var</span> <span class="n">handle</span><span class="p">,</span> <span class="n">position</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">===</span> <span class="nb">self</span><span class="o">.</span><span class="n">lastDraw</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kp">true</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="n">handle</span>   <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="n">stop</span><span class="p">();</span>
            <span class="n">position</span> <span class="o">=</span> <span class="nb">self</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;px&#39;</span><span class="p">;</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">animate</span> <span class="o">&amp;&amp;</span> <span class="nb">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">effects</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">animate</span><span class="p">({</span> <span class="n">left</span><span class="p">:</span> <span class="n">position</span> <span class="p">},</span> <span class="p">{</span>
                    <span class="n">duration</span><span class="p">:</span> <span class="nb">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">effectSpeed</span><span class="p">,</span>
                    <span class="n">step</span><span class="p">:</span>     <span class="nb">self</span><span class="o">.</span><span class="n">redrawDeltaBarInStep</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
                <span class="p">});</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">handle</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">position</span><span class="p">);</span>
                <span class="nb">self</span><span class="o">.</span><span class="n">redrawDeltaBar</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">handle</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>

        <span class="n">this</span><span class="o">.</span><span class="n">lastDraw</span> <span class="o">=</span> <span class="n">_</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### redrawDeltaBar</span>
<span class="sr">     *</span>
<span class="sr">     * Positions the blue delta bar so that it originates at a position where</span>
<span class="sr">     * the value 0 is. Accepts a `value` argument so that it may be used</span>
<span class="sr">     * within a `step` callback in a jQuery `animate` call.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">Renderer</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">redrawDeltaBar</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">handle</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">left</span> <span class="o">=</span> <span class="n">null</span><span class="p">,</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">null</span><span class="p">,</span>
            <span class="n">drawAt</span> <span class="o">=</span> <span class="n">parseInt</span><span class="p">(</span><span class="n">handle</span><span class="o">.</span><span class="n">position</span><span class="p">()</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="n">this</span><span class="o">.</span><span class="n">barHeight</span><span class="p">;</span>

        <span class="n">this</span><span class="o">.</span><span class="n">deltaBar</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="kp">true</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">handle</span> <span class="o">===</span> <span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">left</span> <span class="o">=</span> <span class="n">drawAt</span><span class="p">;</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="n">right</span> <span class="o">=</span> <span class="n">drawAt</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="n">left</span>  <span class="o">=</span> <span class="n">value</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">;</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">value</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="n">position</span> <span class="n">with</span> <span class="n">the</span> <span class="n">left</span> <span class="n">edge</span> <span class="n">underneath</span> <span class="n">the</span> <span class="n">handle</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span>
            <span class="sr">//</span> <span class="n">right</span> <span class="n">edge</span> <span class="n">at</span> <span class="mi">0</span>
            <span class="n">left</span>  <span class="o">=</span> <span class="n">drawAt</span><span class="p">;</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kp">true</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="n">position</span> <span class="n">with</span> <span class="n">the</span> <span class="n">right</span> <span class="n">edge</span> <span class="n">underneath</span> <span class="n">the</span> <span class="n">handle</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span>
            <span class="sr">//</span> <span class="n">left</span> <span class="n">edge</span> <span class="n">at</span> <span class="mi">0</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">drawAt</span><span class="p">;</span>
            <span class="n">left</span>  <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">position</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kp">true</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">left</span> <span class="o">!==</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">this</span><span class="o">.</span><span class="n">deltaBar</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">right</span> <span class="o">!==</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">right</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="n">right</span><span class="p">;</span>
            <span class="n">this</span><span class="o">.</span><span class="n">deltaBar</span><span class="o">.</span><span class="n">css</span><span class="p">(</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">right</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### redrawDeltaBarInStep</span>
<span class="sr">     *</span>
<span class="sr">     * Draws the delta bar from within the step function during a jQuery</span>
<span class="sr">     * animation.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">Renderer</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">redrawDeltaBarInStep</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">handle</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">this</span><span class="o">.</span><span class="n">deltaBar</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">function</span><span class="p">()</span> <span class="p">{};</span>
        <span class="p">}</span>

        <span class="n">var</span> <span class="n">min</span>    <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">drawTo</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
            <span class="n">max</span>    <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">drawTo</span><span class="o">.</span><span class="n">right</span><span class="p">,</span>
            <span class="n">adjust</span> <span class="o">=</span> <span class="no">Math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">deltaBar</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span>
            <span class="nb">self</span>   <span class="o">=</span> <span class="n">this</span><span class="p">;</span>

        <span class="k">return</span> <span class="n">function</span> <span class="p">(</span><span class="n">now</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">now</span> <span class="o">=</span> <span class="p">(</span><span class="n">now</span> <span class="o">+</span> <span class="n">adjust</span><span class="p">)</span> <span class="o">/</span> <span class="nb">self</span><span class="o">.</span><span class="n">width</span><span class="p">;</span>

            <span class="sr">//</span> <span class="s2">&quot;now&quot;</span> <span class="n">is</span> <span class="n">the</span> <span class="n">current</span> <span class="s2">&quot;left&quot;</span> <span class="n">position</span> <span class="n">of</span> <span class="n">the</span> <span class="n">handle</span><span class="o">.</span>
            <span class="sr">//</span> <span class="no">Convert</span> <span class="n">that</span> <span class="n">to</span> <span class="n">the</span> <span class="n">equivalent</span> <span class="n">value</span><span class="o">.</span> <span class="no">For</span> <span class="n">example</span><span class="p">,</span>
            <span class="sr">//</span> <span class="k">if</span> <span class="n">the</span> <span class="n">slider</span> <span class="n">is</span> <span class="mi">0</span><span class="o">-&gt;</span><span class="mi">200</span><span class="p">,</span> <span class="ow">and</span> <span class="n">now</span> <span class="n">is</span> <span class="mi">20</span><span class="p">,</span> <span class="n">the</span>
            <span class="sr">//</span> <span class="n">equivalent</span> <span class="n">value</span> <span class="n">is</span> <span class="mi">40</span><span class="o">.</span>
            <span class="nb">self</span><span class="o">.</span><span class="n">redrawDeltaBar</span><span class="p">(</span><span class="n">now</span> <span class="o">*</span> <span class="p">(</span><span class="n">max</span> <span class="o">-</span> <span class="n">min</span><span class="p">)</span> <span class="o">+</span> <span class="n">min</span><span class="p">,</span> <span class="n">handle</span><span class="p">);</span>

            <span class="k">return</span> <span class="kp">true</span><span class="p">;</span>
        <span class="p">};</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### position</span>
<span class="sr">     *</span>
<span class="sr">     * Given a slider value, returns the position in pixels where the value is</span>
<span class="sr">     * on the slider bar. For example, in a 200px wide bar whose values are</span>
<span class="sr">     * 1-&gt;100, the value 20 is found 40px from the left of the bar.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">Renderer</span><span class="o">.</span><span class="n">prototype</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">ignoreOverhang</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">var</span> <span class="n">delta</span>    <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">drawTo</span><span class="o">.</span><span class="n">right</span> <span class="o">-</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">drawTo</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
            <span class="n">maxRight</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="n">position</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="n">ignoreOverhang</span><span class="p">)</span> <span class="p">{</span>
            <span class="sr">//</span> <span class="no">When</span> <span class="n">using</span> <span class="n">the</span> <span class="n">position</span> <span class="n">function</span> <span class="k">for</span> <span class="n">drawing</span> <span class="n">the</span> <span class="n">delta</span> <span class="n">bar</span><span class="p">,</span> <span class="n">we</span>
            <span class="sr">//</span> <span class="n">need</span> <span class="n">to</span> <span class="n">account</span> <span class="k">for</span> <span class="n">the</span> <span class="s2">&quot;overhang&quot;</span> <span class="n">margin</span> <span class="n">of</span> <span class="n">the</span> <span class="n">handle</span><span class="o">.</span>
            <span class="n">maxRight</span> <span class="o">-=</span> <span class="n">this</span><span class="o">.</span><span class="n">handles</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">width</span><span class="p">()</span> <span class="o">+</span> <span class="n">this</span><span class="o">.</span><span class="n">handleOverhang</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">position</span> <span class="o">=</span> <span class="p">((</span><span class="n">value</span> <span class="o">-</span> <span class="n">this</span><span class="o">.</span><span class="n">quinn</span><span class="o">.</span><span class="n">drawTo</span><span class="o">.</span><span class="n">left</span><span class="p">)</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">maxRight</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">position</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">position</span> <span class="o">&gt;</span> <span class="n">maxRight</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">maxRight</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="no">Math</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">position</span><span class="p">);</span>
    <span class="p">};</span>

    <span class="sr">/**</span>
<span class="sr">     * ### Options</span>
<span class="sr">     *</span>
<span class="sr">     * Default option values which are used when the user does not explicitly</span>
<span class="sr">     * provide them.</span>
<span class="sr">     */</span>
    <span class="no">Quinn</span><span class="o">.</span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sr">//</span> <span class="no">The</span> <span class="n">minimum</span> <span class="n">value</span> <span class="n">which</span> <span class="n">may</span> <span class="n">be</span> <span class="n">selected</span> <span class="n">by</span> <span class="n">a</span> <span class="n">user</span><span class="o">.</span>
        <span class="n">min</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">The</span> <span class="n">maximum</span> <span class="n">value</span> <span class="n">which</span> <span class="n">may</span> <span class="n">be</span> <span class="n">selected</span> <span class="n">by</span> <span class="n">a</span> <span class="n">user</span><span class="o">.</span>
        <span class="n">max</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">If</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">the</span> <span class="n">slider</span> <span class="n">to</span> <span class="n">be</span> <span class="n">drawn</span> <span class="n">so</span> <span class="n">that</span> <span class="n">it</span> <span class="n">is</span> <span class="n">wider</span> <span class="n">than</span> <span class="n">the</span>
        <span class="sr">//</span> <span class="n">range</span> <span class="n">of</span> <span class="n">values</span> <span class="n">which</span> <span class="n">a</span> <span class="n">user</span> <span class="n">may</span> <span class="nb">select</span><span class="p">,</span> <span class="n">supply</span> <span class="n">the</span> <span class="n">values</span> <span class="n">as</span> <span class="n">a</span>
        <span class="sr">//</span> <span class="n">two</span><span class="o">-</span><span class="n">element</span> <span class="n">array</span><span class="o">.</span>
        <span class="n">drawTo</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">The</span> <span class="s2">&quot;steps&quot;</span> <span class="n">by</span> <span class="n">which</span> <span class="n">the</span> <span class="n">selectable</span> <span class="n">value</span> <span class="n">increases</span><span class="o">.</span> <span class="no">For</span> <span class="n">example</span><span class="p">,</span>
        <span class="sr">//</span> <span class="k">when</span> <span class="n">set</span> <span class="n">to</span> <span class="mi">2</span><span class="p">,</span> <span class="n">the</span> <span class="n">default</span> <span class="n">slider</span> <span class="n">will</span> <span class="n">increase</span> <span class="k">in</span> <span class="n">steps</span> <span class="n">from</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
        <span class="sr">//</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
        <span class="n">step</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">The</span> <span class="n">initial</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">slider</span><span class="o">.</span> <span class="n">null</span> <span class="o">=</span> <span class="n">use</span> <span class="n">the</span> <span class="n">lowest</span> <span class="n">permitted</span>
        <span class="sr">//</span> <span class="n">value</span><span class="o">.</span>
        <span class="n">value</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Snaps</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">value</span> <span class="n">to</span> <span class="n">fit</span> <span class="n">with</span> <span class="n">the</span> <span class="n">given</span> <span class="s2">&quot;step&quot;</span> <span class="n">value</span><span class="o">.</span> <span class="no">For</span>
        <span class="sr">//</span> <span class="n">example</span><span class="p">,</span> <span class="n">given</span> <span class="n">a</span> <span class="n">step</span> <span class="n">of</span> <span class="mi">0</span><span class="o">.</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">an</span> <span class="n">initial</span> <span class="n">value</span> <span class="n">of</span> <span class="mi">1</span><span class="o">.</span><span class="mo">05</span><span class="p">,</span> <span class="n">the</span>
        <span class="sr">//</span> <span class="n">value</span> <span class="n">will</span> <span class="n">be</span> <span class="n">changes</span> <span class="n">to</span> <span class="n">fit</span> <span class="n">the</span> <span class="n">step</span><span class="p">,</span> <span class="ow">and</span> <span class="n">rounded</span> <span class="n">to</span> <span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span>
        <span class="sr">//</span>
        <span class="sr">//</span> <span class="no">Notes</span><span class="p">:</span>
        <span class="sr">//</span>
        <span class="sr">//</span>  <span class="o">*</span> <span class="no">Even</span> <span class="n">with</span> <span class="sb">`strict`</span> <span class="n">disabled</span><span class="p">,</span> <span class="n">initial</span> <span class="n">values</span> <span class="n">which</span> <span class="n">are</span> <span class="n">outside</span>
        <span class="sr">//</span>    <span class="n">the</span> <span class="n">given</span> <span class="sb">`min`</span> <span class="ow">and</span> <span class="sb">`max`</span> <span class="n">will</span> <span class="n">still</span> <span class="n">be</span> <span class="n">changed</span> <span class="n">to</span> <span class="n">fit</span> <span class="n">within</span>
        <span class="sr">//</span>    <span class="n">the</span> <span class="n">permitted</span> <span class="n">range</span><span class="o">.</span>
        <span class="sr">//</span>
        <span class="sr">//</span>  <span class="o">*</span> <span class="no">The</span> <span class="sb">`strict`</span> <span class="n">setting</span> <span class="n">affects</span> <span class="n">the</span> <span class="o">*</span><span class="n">initial</span> <span class="n">value</span> <span class="n">only</span><span class="o">*.</span>
        <span class="n">strict</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Restrics</span> <span class="n">the</span> <span class="n">values</span> <span class="n">which</span> <span class="n">may</span> <span class="n">be</span> <span class="n">chosen</span> <span class="n">to</span> <span class="n">those</span> <span class="n">listed</span> <span class="k">in</span> <span class="n">the</span>
        <span class="sr">//</span> <span class="sb">`only`</span> <span class="n">array</span><span class="o">.</span>
        <span class="n">only</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Disables</span> <span class="n">the</span> <span class="n">slider</span> <span class="k">when</span> <span class="n">initialized</span> <span class="n">so</span> <span class="n">that</span> <span class="n">a</span> <span class="n">user</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">change</span>
        <span class="sr">//</span> <span class="n">it</span><span class="s1">&#39;s value.</span>
<span class="s1">        disable: false,</span>

<span class="s1">        // By default, Quinn fades the opacity of the slider to 50% when</span>
<span class="s1">        // disabled, however this may not work perfectly with older Internet</span>
<span class="s1">        // Explorer versions when using transparent PNGs. Setting this to 1.0</span>
<span class="s1">        // will tell Quinn not to fade the slider when disabled.</span>
<span class="s1">        disabledOpacity: 0.5,</span>

<span class="s1">        // If using Quinn on an element which isn&#39;</span><span class="n">t</span> <span class="n">attached</span> <span class="n">to</span> <span class="n">the</span> <span class="no">DOM</span><span class="p">,</span> <span class="n">the</span>
        <span class="sr">//</span> <span class="n">library</span> <span class="n">won</span><span class="s1">&#39;t be able to determine it&#39;</span><span class="n">s</span> <span class="n">width</span><span class="p">;</span> <span class="n">supply</span> <span class="n">it</span> <span class="n">as</span> <span class="n">a</span>
        <span class="sr">//</span> <span class="n">number</span> <span class="p">(</span><span class="k">in</span> <span class="n">pixels</span><span class="p">)</span><span class="o">.</span>
        <span class="n">width</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">If</span> <span class="n">using</span> <span class="no">Quinn</span> <span class="n">on</span> <span class="n">an</span> <span class="n">element</span> <span class="n">which</span> <span class="n">isn</span><span class="s1">&#39;t attached to the DOM, the</span>
<span class="s1">        // library won&#39;</span><span class="n">t</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">the</span> <span class="n">width</span> <span class="n">of</span> <span class="n">the</span> <span class="n">handle</span><span class="p">;</span> <span class="n">suppl</span>
        <span class="sr">//</span> <span class="n">it</span> <span class="n">as</span> <span class="n">a</span> <span class="n">number</span> <span class="p">(</span><span class="k">in</span> <span class="n">pixels</span><span class="p">)</span><span class="o">.</span>
        <span class="n">handleWidth</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="n">A</span> <span class="n">callback</span> <span class="n">which</span> <span class="n">is</span> <span class="n">run</span> <span class="k">when</span> <span class="n">changing</span> <span class="n">the</span> <span class="n">slider</span> <span class="n">value</span><span class="o">.</span> <span class="no">Additional</span>
        <span class="sr">//</span> <span class="n">callbacks</span> <span class="n">may</span> <span class="n">be</span> <span class="n">added</span> <span class="n">with</span> <span class="no">Quinn</span><span class="o">::</span><span class="n">on</span><span class="p">(</span><span class="s1">&#39;drag&#39;</span><span class="p">)</span><span class="o">.</span>
        <span class="sr">//</span>
        <span class="sr">//</span> <span class="no">Arguments</span><span class="p">:</span>
        <span class="sr">//</span>   <span class="n">number</span><span class="p">:</span> <span class="n">the</span> <span class="n">altered</span> <span class="n">slider</span> <span class="n">value</span>
        <span class="sr">//</span>   <span class="no">Quinn</span><span class="p">:</span>  <span class="n">the</span> <span class="no">Quinn</span> <span class="n">instance</span>
        <span class="sr">//</span>
        <span class="n">drag</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Run</span> <span class="n">after</span> <span class="n">the</span> <span class="n">user</span> <span class="n">has</span> <span class="n">finished</span> <span class="n">making</span> <span class="n">a</span> <span class="n">change</span><span class="o">.</span>
        <span class="sr">//</span>
        <span class="sr">//</span> <span class="no">Arguments</span><span class="p">:</span>
        <span class="sr">//</span>   <span class="n">number</span><span class="p">:</span> <span class="n">the</span> <span class="kp">new</span> <span class="n">slider</span> <span class="n">value</span>
        <span class="sr">//</span>   <span class="no">Quinn</span><span class="p">:</span>  <span class="n">the</span> <span class="no">Quinn</span> <span class="n">instance</span>
        <span class="sr">//</span>
        <span class="n">change</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Run</span> <span class="n">once</span> <span class="n">after</span> <span class="n">the</span> <span class="n">slider</span> <span class="n">has</span> <span class="n">been</span> <span class="n">constructed</span><span class="o">.</span>
        <span class="sr">//</span>
        <span class="sr">//</span> <span class="no">Arguments</span><span class="p">:</span>
        <span class="sr">//</span>   <span class="n">number</span><span class="p">:</span> <span class="n">the</span> <span class="n">current</span> <span class="n">slider</span> <span class="n">value</span>
        <span class="sr">//</span>   <span class="no">Quinn</span><span class="p">:</span>  <span class="n">the</span> <span class="no">Quinn</span> <span class="n">instance</span>
        <span class="sr">//</span>
        <span class="n">setup</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">An</span> <span class="n">optional</span> <span class="k">class</span> <span class="n">which</span> <span class="n">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">render</span> <span class="n">the</span> <span class="no">Quinn</span> <span class="no">DOM</span> <span class="n">elements</span>
        <span class="sr">//</span> <span class="ow">and</span> <span class="n">redraw</span> <span class="n">them</span> <span class="k">when</span> <span class="n">the</span> <span class="n">slider</span> <span class="n">value</span> <span class="n">is</span> <span class="n">changed</span><span class="o">.</span> <span class="no">This</span> <span class="n">should</span> <span class="n">be</span>
        <span class="sr">//</span> <span class="n">the</span> <span class="n">class</span><span class="p">;</span> <span class="no">Quinn</span> <span class="n">will</span> <span class="n">create</span> <span class="n">the</span> <span class="n">instance</span><span class="p">,</span> <span class="n">passing</span> <span class="n">the</span> <span class="n">wrapper</span>
        <span class="sr">//</span> <span class="n">element</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">options</span> <span class="n">used</span> <span class="k">when</span> <span class="err">$</span><span class="p">(</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="p">)</span><span class="o">.</span><span class="n">quinn</span><span class="p">()</span> <span class="n">is</span> <span class="n">called</span><span class="o">.</span>
        <span class="sr">//</span>
        <span class="sr">//</span> <span class="no">Arguments</span><span class="p">:</span>
        <span class="sr">//</span>   <span class="no">Quinn</span><span class="p">:</span>  <span class="n">the</span> <span class="no">Quinn</span> <span class="n">instance</span>
        <span class="sr">//</span>   <span class="n">object</span><span class="p">:</span> <span class="n">the</span> <span class="n">options</span> <span class="n">passed</span> <span class="n">to</span> <span class="vg">$.</span><span class="n">fn</span><span class="o">.</span><span class="n">quinn</span>
        <span class="sr">//</span>
        <span class="n">renderer</span><span class="p">:</span> <span class="no">Quinn</span><span class="o">.</span><span class="n">Renderer</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Enables</span> <span class="n">a</span> <span class="n">slightly</span> <span class="n">delay</span> <span class="n">after</span> <span class="n">keyboard</span> <span class="n">events</span><span class="p">,</span> <span class="k">in</span> <span class="k">case</span> <span class="n">the</span> <span class="n">user</span>
        <span class="sr">//</span> <span class="n">presses</span> <span class="n">the</span> <span class="n">key</span> <span class="n">multiple</span> <span class="n">times</span> <span class="k">in</span> <span class="n">quick</span> <span class="n">succession</span><span class="o">.</span> <span class="no">False</span> <span class="n">disables</span><span class="p">,</span>
        <span class="sr">//</span> <span class="n">otherwise</span> <span class="n">provide</span> <span class="n">a</span> <span class="n">integer</span> <span class="n">indicating</span> <span class="n">how</span> <span class="n">many</span> <span class="n">milliseconds</span> <span class="n">to</span>
        <span class="sr">//</span> <span class="n">wait</span><span class="o">.</span>
        <span class="n">keyFloodWait</span><span class="p">:</span> <span class="kp">false</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">When</span> <span class="n">using</span> <span class="n">animations</span> <span class="p">(</span><span class="n">such</span> <span class="n">as</span> <span class="n">clicking</span> <span class="n">on</span> <span class="n">the</span> <span class="n">bar</span><span class="p">),</span> <span class="n">how</span> <span class="n">long</span>
        <span class="sr">//</span> <span class="n">should</span> <span class="n">the</span> <span class="n">duration</span> <span class="n">be?</span> <span class="no">Any</span> <span class="n">jQuery</span> <span class="n">effect</span> <span class="n">duration</span> <span class="n">value</span> <span class="n">is</span>
        <span class="sr">//</span> <span class="n">permitted</span><span class="o">.</span>
        <span class="n">effectSpeed</span><span class="p">:</span> <span class="s1">&#39;fast&#39;</span><span class="p">,</span>

        <span class="sr">//</span> <span class="no">Set</span> <span class="n">to</span> <span class="kp">false</span> <span class="n">to</span> <span class="n">disable</span> <span class="n">all</span> <span class="n">animation</span> <span class="n">on</span> <span class="n">the</span> <span class="n">slider</span><span class="o">.</span>
        <span class="n">effects</span><span class="p">:</span> <span class="kp">true</span>
    <span class="p">};</span>

    <span class="sr">//</span> <span class="o">-----------------------------------------------------------------------</span>

    <span class="sr">//</span> <span class="no">The</span> <span class="n">jQuery</span> <span class="n">helper</span> <span class="n">function</span><span class="o">.</span> <span class="no">Permits</span> <span class="err">$</span><span class="p">(</span><span class="o">.</span><span class="n">.</span><span class="o">.</span><span class="p">)</span><span class="o">.</span><span class="n">quinn</span><span class="p">();</span>
    <span class="vg">$.</span><span class="n">fn</span><span class="o">.</span><span class="n">quinn</span> <span class="o">=</span> <span class="n">function</span> <span class="p">(</span><span class="n">options</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="vg">$.</span><span class="n">each</span><span class="p">(</span><span class="n">this</span><span class="p">,</span> <span class="n">function</span> <span class="p">()</span> <span class="p">{</span> <span class="kp">new</span> <span class="no">Quinn</span><span class="p">(</span><span class="err">$</span><span class="p">(</span><span class="n">this</span><span class="p">),</span> <span class="n">options</span><span class="p">);</span> <span class="p">});</span>
    <span class="p">};</span>

    <span class="sr">//</span> <span class="no">Expose</span> <span class="no">Quinn</span> <span class="n">to</span> <span class="n">the</span> <span class="n">world</span> <span class="n">on</span> <span class="vg">$.</span><span class="no">Quinn</span><span class="o">.</span>
    <span class="vg">$.</span><span class="no">Quinn</span> <span class="o">=</span> <span class="no">Quinn</span><span class="p">;</span>

<span class="p">})(</span><span class="n">jQuery</span><span class="p">,</span> <span class="n">_</span><span class="p">);</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>
